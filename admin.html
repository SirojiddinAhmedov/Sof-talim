<!doctype html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin</title>
  <style>
    body{
    font-family:system-ui,Arial;
    min-height:100vh;
    background:#0b1220;
    color:#e8eefc;
    margin:0
}
 header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:16px 18px;
    border-bottom:1px solid #243255;
    background:#0d1528
}
 .wrap{
    padding:18px;
    max-width:920px;
    margin:auto
}
 .card{
    background:#121b2f;
    border:1px solid #243255;
    border-radius:16px;
    padding:18px
}
 button{
    padding:10px 12px;
    border:0;
    border-radius:12px;
    background:#ff5d5d;
    color:white;
    font-weight:600;
    cursor:pointer
}
 .ok{
    color:#9ff0c2
}
/* Chartlar joylashuvi: faqat pastga */
.charts{
  display: flex;
  flex-direction: column;   /* faqat vertikal */
  gap: 16px;                /* orasidagi masofa */
  margin-top: 12px;
}

/* Har bir grafik kartasi */
.chart{
  background: #0d1528;
  border: 1px solid #243255;
  border-radius: 14px;
  padding: 12px;
  overflow: hidden;        /* ichki scrollni yashiradi */

  display: flex;
  justify-content: center;
}

/* Iframe o'lchami */
.chart iframe{
  width: 100%;
  height: 360px;
  border: 0;
  display: block;

  /* üëá eng muhim: kenglikni ‚Äúqotirib‚Äù qo'ymaymiz */
  width: min(900px, 100%);
  height: 360px;
}

/* Mobil */
@media (max-width: 768px){
  .chart iframe{ height: 300px; }
}
@media (max-width: 480px){
  .chart iframe{ height: 240px; }
}

  </style>
</head>
<body>
  <header>
    <div><b>Admin panel</b> <span class="ok" id="who"></span></div>
    <button id="logout">Chiqish</button>
  </header>
      <div class="wrap">
  <div class="card">
    <div class="charts">
      <div class="chart">
        <iframe
          src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSA9wbH4mVc4N3g43H3xy6N4TqaCyzrcBaF7forQAbCk3u0dIBCDs3JwdTNLYsBrQ5at_z3tAOvE8NB/pubchart?oid=1068264919&format=interactive"
          loading="lazy"
          scrolling="no"
          referrerpolicy="no-referrer-when-downgrade">
        </iframe>
      </div>

      <div class="chart">
        <iframe
          src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTKaQmkgP6CwbHSOE-6hsM74Qvi31OEzpyNleYuuPDoqNIII8mMEpMHVDpFnPydFSbUxEq2lr2zbl4c/pubchart?oid=1770476781&format=interactive"
          loading="lazy"
          scrolling="no"
          referrerpolicy="no-referrer-when-downgrade">
        </iframe>
      </div>

      <div class="chart">
        <iframe
          src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTKaQmkgP6CwbHSOE-6hsM74Qvi31OEzpyNleYuuPDoqNIII8mMEpMHVDpFnPydFSbUxEq2lr2zbl4c/pubchart?oid=703273994&format=interactive"
          loading="lazy"
          scrolling="no"
          referrerpolicy="no-referrer-when-downgrade">
        </iframe>
      </div>

      <div class="chart">
        <iframe width="600" height="371" seamless frameborder="0" scrolling="no" src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTKaQmkgP6CwbHSOE-6hsM74Qvi31OEzpyNleYuuPDoqNIII8mMEpMHVDpFnPydFSbUxEq2lr2zbl4c/pubchart?oid=141678422&amp;format=interactive"></iframe>

      </div>
    </div>
  </div>
</div>


<script>
const token = localStorage.getItem('auth_token');
if (!token) {
  window.location.href = './login.html';
}

async function loadMe() {
  const res = await fetch('http://localhost:3000/api/me', {
    headers: { 'Authorization': 'Bearer ' + token }
  });

  if (!res.ok) {
    localStorage.removeItem('auth_token');
    window.location.href = './login.html';
    return;
  }

  const data = await res.json();
  document.getElementById('who').textContent = `(${data.username})`;
  document.getElementById('secret').textContent = `Session: ${data.session}`;
}

document.getElementById('logout').onclick = () => {
  localStorage.removeItem('auth_token');
  window.location.href = './login.html';
};

loadMe();
</script>
</body>
</html>
